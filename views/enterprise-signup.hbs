<section>
    <h1>üè¢ Enterprise Signup</h1>
    <h2>Get Custom Pricing for Your Team</h2>
    
    <div style="max-width: 600px; margin: 0 auto;">
        <form id="enterprise-form" style="background: #f9f9f9; padding: 30px; border: 1px solid #ccc;">
            <h3>Company Information</h3>
            
            <div style="margin: 15px 0;">
                <label style="display: block; font-weight: bold; margin-bottom: 5px;">Company Name *</label>
                <input type="text" name="company_name" required style="width: 100%; padding: 10px; border: 1px solid #ccc;">
            </div>
            
            <div style="margin: 15px 0;">
                <label style="display: block; font-weight: bold; margin-bottom: 5px;">Company Domain *</label>
                <input type="text" name="company_domain" placeholder="example.com" required style="width: 100%; padding: 10px; border: 1px solid #ccc;">
                <small style="color: #666;">This will be used for SSO configuration</small>
            </div>
            
            <h3 style="margin-top: 30px;">Contact Information</h3>
            
            <div style="margin: 15px 0;">
                <label style="display: block; font-weight: bold; margin-bottom: 5px;">Contact Name *</label>
                <input type="text" name="contact_name" required style="width: 100%; padding: 10px; border: 1px solid #ccc;">
            </div>
            
            <div style="margin: 15px 0;">
                <label style="display: block; font-weight: bold; margin-bottom: 5px;">Contact Email *</label>
                <input type="email" name="contact_email" required style="width: 100%; padding: 10px; border: 1px solid #ccc;">
            </div>
            
            <div style="margin: 15px 0;">
                <label style="display: block; font-weight: bold; margin-bottom: 5px;">Phone Number</label>
                <input type="tel" name="contact_phone" style="width: 100%; padding: 10px; border: 1px solid #ccc;">
            </div>
            
            <h3 style="margin-top: 30px;">Requirements</h3>
            
            <div style="margin: 15px 0;">
                <label style="display: block; font-weight: bold; margin-bottom: 5px;">Estimated Number of Seats *</label>
                <input type="number" name="estimated_seats" min="5" value="10" required style="width: 100%; padding: 10px; border: 1px solid #ccc;">
                <small style="color: #666;">Minimum 5 seats for enterprise plans</small>
            </div>
            
            <div style="margin: 15px 0;">
                <label style="display: block; font-weight: bold; margin-bottom: 5px;">Plan Type</label>
                <select name="plan" style="width: 100%; padding: 10px; border: 1px solid #ccc;">
                    <option value="basic">Basic ($5/seat/month)</option>
                    <option value="pro">Pro ($25/seat/month)</option>
                </select>
            </div>
            
            <div style="margin: 15px 0;">
                <label style="display: block; font-weight: bold; margin-bottom: 10px;">Required Enterprise Features</label>
                <div style="margin-left: 20px;">
                    <label style="display: block; margin: 5px 0;">
                        <input type="checkbox" name="features" value="sso" checked> 
                        Single Sign-On (SSO) - $125/month
                    </label>
                    <label style="display: block; margin: 5px 0;">
                        <input type="checkbox" name="features" value="directorySync" checked> 
                        Directory Sync (SCIM) - $125/month
                    </label>
                    <label style="display: block; margin: 5px 0;">
                        <input type="checkbox" name="features" value="authorization"> 
                        Fine-Grained Authorization - Free
                    </label>
                    <label style="display: block; margin: 5px 0;">
                        <input type="checkbox" name="features" value="auditLogs" checked> 
                        Audit Logs - $5/month
                    </label>
                </div>
            </div>
            
            <div style="margin: 15px 0;">
                <label style="display: block; font-weight: bold; margin-bottom: 5px;">Additional Requirements</label>
                <textarea name="notes" rows="4" placeholder="Tell us about any specific requirements, integration needs, or questions..." style="width: 100%; padding: 10px; border: 1px solid #ccc;"></textarea>
            </div>
            
            <div id="pricing-preview" style="margin: 20px 0; padding: 20px; background: #e8f5e8; border: 1px solid #4caf50; display: none;">
                <h4>üí∞ Estimated Monthly Pricing</h4>
                <div id="pricing-breakdown"></div>
            </div>
            
            <div style="margin: 30px 0; text-align: center;">
                <button type="button" onclick="updatePricingPreview()" style="padding: 10px 20px; background: #666; color: white; border: none; margin-right: 10px;">
                    Preview Pricing
                </button>
                <button type="submit" style="padding: 15px 30px; background: #4caf50; color: white; border: none; font-weight: bold; font-size: 16px;">
                    Submit Enterprise Request
                </button>
            </div>
            
            <p style="font-size: 14px; color: #666; text-align: center;">
                No commitment required. We'll review your requirements and contact you within 24 hours.
            </p>
        </form>
        
        <div id="success-message" style="display: none; text-align: center; padding: 30px; background: #e8f5e8; border: 1px solid #4caf50; margin-top: 20px;">
            <h3>‚úÖ Enterprise Request Submitted!</h3>
            <p>Thank you for your interest in Battle Cards Enterprise.</p>
            <div id="next-steps"></div>
            <p><a href="/dashboard">‚Üê Back to Dashboard</a></p>
        </div>
    </div>
</section>

<script>
function updatePricingPreview() {
    const form = document.getElementById('enterprise-form');
    const formData = new FormData(form);
    
    const seats = formData.get('estimated_seats');
    const plan = formData.get('plan');
    const features = {
        sso: formData.getAll('features').includes('sso'),
        directorySync: formData.getAll('features').includes('directorySync'),
        authorization: formData.getAll('features').includes('authorization'),
        auditLogs: formData.getAll('features').includes('auditLogs')
    };
    
    fetch('/enterprise/calculate-pricing', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({ seats, plan, features })
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            const pricing = data.pricing;
            document.getElementById('pricing-breakdown').innerHTML = `
                <table style="width: 100%; border-collapse: collapse;">
                    <tr><td>Battle Cards Seats:</td><td>$${pricing.seatCost}</td></tr>
                    <tr><td>WorkOS Enterprise Features:</td><td>$${pricing.workosFeatures.total}</td></tr>
                    <tr><td>Support & Management (30%):</td><td>$${pricing.supportFee.toFixed(2)}</td></tr>
                    <tr style="border-top: 2px solid #333; font-weight: bold;"><td>Total Monthly:</td><td>$${pricing.total.toFixed(2)}</td></tr>
                </table>
            `;
            document.getElementById('pricing-preview').style.display = 'block';
        }
    });
}

document.getElementById('enterprise-form').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const formData = new FormData(this);
    const data = {
        company_name: formData.get('company_name'),
        company_domain: formData.get('company_domain'),
        contact_name: formData.get('contact_name'),
        contact_email: formData.get('contact_email'),
        contact_phone: formData.get('contact_phone'),
        estimated_seats: formData.get('estimated_seats'),
        plan: formData.get('plan'),
        features: formData.getAll('features'),
        notes: formData.get('notes')
    };
    
    fetch('/enterprise/signup', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(data)
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            document.getElementById('enterprise-form').style.display = 'none';
            document.getElementById('next-steps').innerHTML = `
                <div style="text-align: left; margin: 20px 0;">
                    <h4>What happens next:</h4>
                    <ul>
                        ${data.next_steps.map(step => `<li>${step}</li>`).join('')}
                    </ul>
                    <h4>üìä Your Pricing Summary:</h4>
                    <p><strong>Monthly Total: $${data.pricing.total.toFixed(2)}</strong></p>
                </div>
            `;
            document.getElementById('success-message').style.display = 'block';
        } else {
            alert('Error: ' + data.error);
        }
    })
    .catch(error => {
        console.error('Submission error:', error);
        alert('Error submitting form. Please try again.');
    });
});

// Auto-update pricing when fields change
document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('enterprise-form');
    form.addEventListener('change', updatePricingPreview);
    updatePricingPreview(); // Initial calculation
});
</script> 